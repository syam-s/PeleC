

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Getting Started &mdash; PeleC 0.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Boundary Conditions" href="BoundaryConditions.html" />
    <link rel="prev" title="Numerical Treatment and Algorithms" href="Algorithms.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> PeleC
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Equations.html">Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="Algorithms.html">Numerical Treatment and Algorithms</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#navigation">Navigation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#building">Building</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#gnu-make">GNU Make</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cmake">CMake</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#input-files-and-controls">Input Files and Controls</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tutorials">Tutorials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#eb-sphere">EB_Sphere</a></li>
<li class="toctree-l3"><a class="reference internal" href="#eb-obliqshock">EB_ObliqShock</a></li>
<li class="toctree-l3"><a class="reference internal" href="#eb-bluffbody">EB_BluffBody</a></li>
<li class="toctree-l3"><a class="reference internal" href="#eb-channel">EB_Channel</a></li>
<li class="toctree-l3"><a class="reference internal" href="#eb-stube">EB_stube</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#testing-and-verification">Testing and Verification</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#building-the-tests">Building the Tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-the-tests">Running the Tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adding-tests">Adding Tests</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="BoundaryConditions.html">Boundary Conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="geometry/EB.html">Geometry treatment in PeleC</a></li>
<li class="toctree-l1"><a class="reference internal" href="LES.html">LES and Hybrid LES/DNS Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="VandV.html">Correctness - Verification and Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="PelePhysics.html">PelePhysics</a></li>
<li class="toctree-l1"><a class="reference internal" href="miscellaneous/miscellaneous.html">Miscellaneous Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="boxlib_bits.html">Development Reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PeleC</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Getting Started</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/GettingStarted.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="getting-started">
<span id="gettingstarted"></span><h1>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<div class="section" id="navigation">
<h2>Navigation<a class="headerlink" href="#navigation" title="Permalink to this headline">¶</a></h2>
<p>The PeleC directory structure is as shown below:</p>
<ul class="simple">
<li><p><strong>Source</strong> - C++ source code</p></li>
<li><p><strong>Util</strong> - third party utilities</p>
<ul>
<li><p>BLAS</p></li>
<li><p>LAPACK</p></li>
<li><p>VODE</p></li>
<li><p>plot1d</p></li>
</ul>
</li>
<li><p><strong>Docs</strong>   - PeleC documentation</p>
<ul>
<li><p>sphinx</p></li>
</ul>
</li>
<li><p><strong>ExecCpp</strong> - regression tests and various capability demonstrations</p>
<ul>
<li><p><a class="reference internal" href="VandV.html#vandv"><span class="std std-ref">Regression Tests</span></a></p>
<ul>
<li><p>EB_MMS   - Method of manufactured solutions</p></li>
<li><p>HIT      - Box of homogeneous isotropic turbulence</p></li>
<li><p>MMS      - Method of manufactured solutions</p></li>
<li><p>PMF      - 2D Premixed H2-air flame calculation</p></li>
<li><p>Sedov    - Sedov blast wave test</p></li>
<li><p>Sod      - Sod shock tube test</p></li>
<li><p>TG       - Taylor-Green vortex test</p></li>
<li><p>zeroD    - Single cell test for reaction model</p></li>
</ul>
</li>
<li><p>UnitTests</p>
<ul>
<li><p>NSCBC_test_cases - This directory contains many 1D, 2D and 3D cases to test the implementation of the Ghost-Cells Navier-Stokes Boundary Conditions (GC-NSCBC) on various different configurations.</p></li>
<li><p>HIT_forced - This test case is similar to the homogeneous isotropic turbulence present in the RegTests directory, at the exception that we are not starting from a turbulent initial solution, but from a flow at rest where we superimpose forcing sources to generate turbulence.</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="tutorials.html#tutorials"><span class="std std-ref">Tutorials</span></a></p>
<ul>
<li><p>EB_Sphere - Reacting flow around a sphere</p></li>
<li><p>EB_OblqShock - Supersonic flow over a wedge resulting in a steady attached oblique shock</p></li>
<li><p>EB_BluffBody -  Non-reacting flow around a diamond-shaped body</p></li>
<li><p>Spray</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Setting up a problem to run with PeleC involves writing an input file and problem specific code in the run directory.
PeleC is built using the AMReX build system which supports out-of-source builds but as configured in Pele requires a specific directory structure.
Within each case directory in Exec, are the source files that specify the setup of that particular case.
The user has to build each case by compiling source files using a GNUMakefile which also compiles and links together AMReX and PeleC sources.
The source files contained in the case directory are treated preferentially and can override PeleC/AMReX source files.
A few key files that need to be supplied for (most) cases are:</p>
<p><strong>inputs</strong> – a text file containing parameters that are ready by the ParmParse capability in AMReX. These include things like number of time steps, grid size, output file frequency, which physics to include, etc.
A list of available data in the Pele group can be found in PeleC/Source/param_includes/pelec_params.H</p>
<p><strong>prob.cpp</strong> – Routines called at:</p>
<blockquote>
<div><ul class="simple">
<li><p>Initialization (<cite>amrex_probinit</cite>)</p></li>
<li><p>To set initial values on the grid (<cite>pc_initdata</cite>)</p></li>
<li><p>Problem teardown (<cite>pc_prob_close</cite>)</p></li>
</ul>
</div></blockquote>
<p><strong>prob.H</strong> – Something about prob.H</p>
<p><strong>prob_parm.H</strong> – Something about prob_parm.H</p>
<p><strong>GNUMakefile</strong> – In addition to setting options to build profiling, debugging, MPI, OpenMP, Compiler toolchain options, the chemical mechanism, transport model, equation of state model, and use of EB are set here for compile time selection. The GNUMakefile includes the <code class="docutils literal notranslate"><span class="pre">Make.PeleC</span></code> file from the <cite>ExecCpp</cite> directory that contains build configuration common across the examples.</p>
</div>
<div class="section" id="building">
<span id="id1"></span><h2>Building<a class="headerlink" href="#building" title="Permalink to this headline">¶</a></h2>
<p>PeleC uses executables which are customized to the case in which the user intends to run. As listed earlier, specific source code files are considered input to the program and compiled into the executable itself. Therefore, PeleC has both compile-time and run-time inputs that the user must set for their case. The compile time inputs can be verified by running:</p>
<dl class="simple">
<dt>::</dt><dd><p>./PeleC –describe</p>
</dd>
</dl>
<p>which will print out the build information (including git hashes, modules, EoS, some basic information from compiled chemistry network, etc).</p>
<p>PeleC has the ability to use two build systems. First is the GNU Make build system. This build system is best for use on large computing facility machines and production runs. With the GNU Make implementation, the build system will inspect the machine and use known compiler optimizations explicit to that machine if possible. These explicit settings are kept up-to-date by the AMReX project. The second build system implemented is CMake. This is best used for developers of PeleC and more generalized. CMake allows for building as well as easy testing and verification of PeleC through the use of CTest which is included in CMake.</p>
<div class="section" id="gnu-make">
<h3>GNU Make<a class="headerlink" href="#gnu-make" title="Permalink to this headline">¶</a></h3>
<p>Using the GNU Make build system involves first setting environment variables for the directories of the dependencies of PeleC which are the repositories of AMReX and PelePhysics. AMReX and PelePhysics are provided as git submodules in PeleC and can be populated by using <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">submodule</span> <span class="pre">init;</span> <span class="pre">git</span> <span class="pre">submodule</span> <span class="pre">update</span></code> in the PeleC repo, or before cloning by using <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">clone</span> <span class="pre">--recursive</span> <span class="pre">&lt;pelec_repo&gt;</span></code>. Although submodules of these projects are provided, they can be placed externally as long as the <code class="docutils literal notranslate"><span class="pre">&lt;REPO_HOME&gt;</span></code> environment variables for each dependency is set correctly. An example of setting the <code class="docutils literal notranslate"><span class="pre">&lt;REPO_HOME&gt;</span></code> environment variables in the user’s <code class="docutils literal notranslate"><span class="pre">.bashrc</span></code> is shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>export PELEC_HOME=${HOME}/PeleC
export AMREX_HOME=${PELEC_HOME}/Submodules/AMReX
export PELE_PHYSICS_HOME=${PELEC_HOME}/Submodules/PelePhysics
</pre></div>
</div>
<p>Then one edits the <code class="docutils literal notranslate"><span class="pre">GNUMakefile</span></code> in any of the examples in the <code class="docutils literal notranslate"><span class="pre">ExecCpp</span></code> directory and uses the <code class="docutils literal notranslate"><span class="pre">make</span></code> command to build the executable.</p>
</div>
<div class="section" id="cmake">
<h3>CMake<a class="headerlink" href="#cmake" title="Permalink to this headline">¶</a></h3>
<p>Using CMake involves an additional configure step before using the <code class="docutils literal notranslate"><span class="pre">make</span></code> command. It is also expected that the user has cloned the PeleC repo with the <code class="docutils literal notranslate"><span class="pre">--recursive</span></code> option or performed <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">submodule</span> <span class="pre">init;</span> <span class="pre">git</span> <span class="pre">submodule</span> <span class="pre">update</span></code> in the PeleC repo to populate its submodules.</p>
<p>To build with CMake, a user typically creates a <code class="docutils literal notranslate"><span class="pre">build</span></code> directory in the project directory and in that directory the <code class="docutils literal notranslate"><span class="pre">cmake</span> <span class="pre">&lt;options&gt;</span> <span class="pre">..</span></code> command is used to configure the project before building it. PeleC provides an example build directory called <code class="docutils literal notranslate"><span class="pre">Build</span></code> with example scripts for performing the CMake configure. Once the CMake configure step is done, then the <code class="docutils literal notranslate"><span class="pre">make</span></code> command will build the executable.</p>
<p>An example CMake configure command to build PeleC with MPI is listed below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cmake</span> <span class="o">-</span><span class="n">DCMAKE_BUILD_TYPE</span><span class="p">:</span><span class="n">STRING</span><span class="o">=</span><span class="n">Release</span> \
      <span class="o">-</span><span class="n">DPELEC_ENABLE_MPI</span><span class="p">:</span><span class="n">BOOL</span><span class="o">=</span><span class="n">ON</span> \
      <span class="o">-</span><span class="n">DCMAKE_CXX_COMPILER</span><span class="p">:</span><span class="n">STRING</span><span class="o">=</span><span class="n">mpicxx</span> \
      <span class="o">-</span><span class="n">DCMAKE_C_COMPILER</span><span class="p">:</span><span class="n">STRING</span><span class="o">=</span><span class="n">mpicc</span> \
      <span class="o">-</span><span class="n">DCMAKE_Fortran_COMPILER</span><span class="p">:</span><span class="n">STRING</span><span class="o">=</span><span class="n">mpifort</span> \
      <span class="o">..</span> <span class="o">&amp;&amp;</span> <span class="n">make</span>
</pre></div>
</div>
<p>Note that CMake is able to generate makefiles for the Ninja build system as well which will allow for faster building of the executable(s).</p>
</div>
</div>
<div class="section" id="input-files-and-controls">
<h2>Input Files and Controls<a class="headerlink" href="#input-files-and-controls" title="Permalink to this headline">¶</a></h2>
<p>The input file specified on the command line is a free-format text file, one entry per row, that specifies input data processed by the AMReX <code class="docutils literal notranslate"><span class="pre">ParmParse</span></code> module.</p>
<p>This file needs to specified along with the executable as an <cite>argv</cite> option, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mpirun</span> <span class="o">-</span><span class="n">np</span> <span class="mi">64</span> <span class="o">./</span><span class="n">Pele2d</span><span class="o">.</span><span class="n">xxx</span><span class="p">,</span><span class="n">yyy</span><span class="o">.</span><span class="n">ex</span> <span class="n">inputs</span>
</pre></div>
</div>
<p>Also, any entry that can be specified in the inputs file can also be specified on the command line; values specified on the command line override values in the inputs file, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mpirun</span> <span class="o">-</span><span class="n">np</span> <span class="mi">64</span> <span class="o">./</span><span class="n">Pele2d</span><span class="o">.</span><span class="n">gnu</span><span class="o">.</span><span class="n">DEBUG</span><span class="o">.</span><span class="n">MPI</span><span class="o">.</span><span class="n">ex</span> <span class="n">inputs</span> <span class="n">amr</span><span class="o">.</span><span class="n">restart</span><span class="o">=</span><span class="n">sod_x_chk0030</span> <span class="n">pelec</span><span class="o">.</span><span class="n">riemann_solver</span><span class="o">=</span><span class="mi">3</span>
</pre></div>
</div>
<p>The available options are divided into groups: those that control primarily AMReX are prefaced with <cite>amr.</cite> while those that are specific to Pele are prefaced with <cite>pelec.</cite>.</p>
<p>A typical input file looks something like the example below; a full list of Pele-specific input parameters are in <cite>PeleC/Source/_cpp_parameters</cite>.
These parameters, once read, are available in the <cite>PeleC</cite> object for use from c++ and are also copied to the module <cite>prob_params_module</cite> for use in FORTRAN.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># ------------------  INPUTS TO MAIN PROGRAM  -------------------</span>
<span class="c1">#absolute stop time for the simulation</span>
<span class="n">stop_time</span> <span class="o">=</span> <span class="mi">6</span>

<span class="c1">#maximum number of time steps at base AMR level</span>
<span class="n">max_step</span> <span class="o">=</span> <span class="mi">30</span>
<span class="c1"># ---------------------------------------------------------------</span>

<span class="c1">#------------------------</span>
<span class="c1"># PROBLEM SIZE &amp; GEOMETRY</span>
<span class="c1"># -----------------------</span>

<span class="c1">#flag for periodicity (here x direction is periodic)</span>
<span class="n">geometry</span><span class="o">.</span><span class="n">is_periodic</span> <span class="o">=</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span>

<span class="c1">#0 =&gt; cart, 1 =&gt; RZ  2=&gt;spherical</span>
<span class="n">geometry</span><span class="o">.</span><span class="n">coord_sys</span>   <span class="o">=</span> <span class="mi">0</span>

<span class="c1">#coordinates of domain&#39;s lower corner</span>
<span class="n">geometry</span><span class="o">.</span><span class="n">prob_lo</span>     <span class="o">=</span>   <span class="o">-</span><span class="mf">0.3</span>     <span class="mf">0.0</span>   <span class="mf">0.0</span>

<span class="c1">#coordinates of domain&#39;s upper corner</span>
<span class="n">geometry</span><span class="o">.</span><span class="n">prob_hi</span>     <span class="o">=</span>    <span class="mf">0.3</span>     <span class="mf">0.3</span>   <span class="mf">0.15</span>

<span class="c1">#number of cells along each direction at base level (note: dx=dy=dz)</span>
<span class="n">amr</span><span class="o">.</span><span class="n">n_cell</span>           <span class="o">=</span>    <span class="mi">128</span>     <span class="mi">64</span>    <span class="mi">32</span>
<span class="c1"># ---------------------------------------------------------------</span>

<span class="c1"># ---------------------------------------------------------------</span>
<span class="n">PeleC</span> <span class="n">specific</span> <span class="n">inputs</span>
<span class="c1"># ---------------------------------------------------------------</span>

<span class="c1"># 0: Collela, Glaz and Ferguson (default)</span>
<span class="c1"># 1: Collela and Glaz</span>
<span class="c1"># 2: HLLC</span>
<span class="n">pelec</span><span class="o">.</span><span class="n">riemann_solver</span>    <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;  BC KEYWORDS &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
<span class="c1"># Interior, UserBC, Symmetry, SlipWall, NoSlipWall</span>
<span class="c1"># &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;  BC KEYWORDS &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>

<span class="c1">#boundary condition at the lower face of each coordinate direction</span>
<span class="n">pelec</span><span class="o">.</span><span class="n">lo_bc</span>       <span class="o">=</span>  <span class="s2">&quot;Interior&quot;</span>  <span class="s2">&quot;UserBC&quot;</span>  <span class="s2">&quot;SlipWall&quot;</span>

<span class="c1">#boundary condition at the upper face of each coordinate direction</span>
<span class="n">pelec</span><span class="o">.</span><span class="n">hi_bc</span>       <span class="o">=</span>  <span class="s2">&quot;Interior&quot;</span>  <span class="s2">&quot;UserBC&quot;</span>  <span class="s2">&quot;SlipWall&quot;</span>

<span class="c1">#------------------------</span>
<span class="c1"># TIME STEP CONTROL</span>
<span class="c1">#------------------------</span>

<span class="n">pelec</span><span class="o">.</span><span class="n">cfl</span>            <span class="o">=</span> <span class="mf">0.5</span>     <span class="c1"># cfl number for hyperbolic system</span>
<span class="n">pelec</span><span class="o">.</span><span class="n">init_shrink</span>    <span class="o">=</span> <span class="mf">0.3</span>     <span class="c1"># first timestep is scaled by this factor</span>
<span class="n">pelec</span><span class="o">.</span><span class="n">change_max</span>     <span class="o">=</span> <span class="mf">1.1</span>     <span class="c1"># maximum factor by which timestep can increase</span>
<span class="n">pelec</span><span class="o">.</span><span class="n">dt_cutoff</span>      <span class="o">=</span> <span class="mf">5.e-20</span>  <span class="c1"># level 0 timestep below which we halt</span>

<span class="c1">#------------------------</span>
<span class="c1"># WHICH PHYSICS</span>
<span class="c1">#------------------------</span>

<span class="n">pelec</span><span class="o">.</span><span class="n">do_hydro</span> <span class="o">=</span> <span class="mi">1</span>               <span class="c1"># enable hyperbolic term</span>
<span class="n">pelec</span><span class="o">.</span><span class="n">do_mol_AD</span> <span class="o">=</span> <span class="mi">1</span>              <span class="c1"># use method of lines (MOL)</span>
<span class="n">pelec</span><span class="o">.</span><span class="n">do_react</span> <span class="o">=</span> <span class="mi">0</span>               <span class="c1"># enable chemical reactions</span>
<span class="n">pelec</span><span class="o">.</span><span class="n">ppm_type</span> <span class="o">=</span> <span class="mi">2</span>               <span class="c1"># piecewise parabolic reconstruction type</span>
<span class="n">pelec</span><span class="o">.</span><span class="n">allow_negative_energy</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># flag to allow negative internal energy</span>
<span class="n">pelec</span><span class="o">.</span><span class="n">diffuse_temp</span> <span class="o">=</span> <span class="mi">0</span>           <span class="c1"># enable thermal diffusion</span>
<span class="n">pelec</span><span class="o">.</span><span class="n">diffuse_vel</span>  <span class="o">=</span> <span class="mi">0</span>           <span class="c1"># enable viscous diffusion</span>
<span class="n">pelec</span><span class="o">.</span><span class="n">diffuse_spec</span> <span class="o">=</span> <span class="mi">0</span>           <span class="c1"># enable species diffusion</span>

<span class="c1">#------------------------</span>
<span class="c1"># DIAGNOSTICS &amp; VERBOSITY</span>
<span class="c1">#------------------------</span>

<span class="c1"># coarse time steps between computing integral of</span>
<span class="c1"># conserved variables in the  domain</span>
<span class="c1"># these values should stabilize at steady state</span>
<span class="n">pelec</span><span class="o">.</span><span class="n">sum_interval</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">pelec</span><span class="o">.</span><span class="n">v</span>            <span class="o">=</span> <span class="mi">1</span>        <span class="c1"># verbosity in PeleC cpp files</span>
<span class="n">amr</span><span class="o">.</span><span class="n">v</span>              <span class="o">=</span> <span class="mi">1</span>        <span class="c1"># verbosity in Amr.cpp</span>
<span class="c1">#amr.grid_log       = grdlog  # name of grid logging file</span>
<span class="c1"># ---------------------------------------------------------------</span>

<span class="c1"># ---------------------------------------------------------------</span>
<span class="n">AMR</span> <span class="n">specific</span> <span class="n">inputs</span>
<span class="c1"># ---------------------------------------------------------------</span>

<span class="c1">#------------------------</span>
<span class="c1"># REFINEMENT / REGRIDDING</span>
<span class="c1">#------------------------</span>

<span class="n">amr</span><span class="o">.</span><span class="n">max_level</span>       <span class="o">=</span> <span class="mi">2</span>       <span class="c1"># maximum level number allowed</span>
<span class="n">amr</span><span class="o">.</span><span class="n">ref_ratio</span>       <span class="o">=</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="c1"># refinement ratio across levels</span>
<span class="n">amr</span><span class="o">.</span><span class="n">regrid_int</span>      <span class="o">=</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="c1"># how often to regrid</span>
<span class="n">amr</span><span class="o">.</span><span class="n">blocking_factor</span> <span class="o">=</span> <span class="mi">8</span>       <span class="c1"># block factor in grid generation</span>
<span class="n">amr</span><span class="o">.</span><span class="n">max_grid_size</span>   <span class="o">=</span> <span class="mi">64</span>      <span class="c1"># maximum number of cells per box along x,y,z</span>

<span class="c1">#specify species name as flame tracer for</span>
<span class="c1">#refinement purposes</span>
<span class="n">pelec</span><span class="o">.</span><span class="n">flame_trac_name</span> <span class="o">=</span> <span class="n">HO2</span>

<span class="c1">#------------------------</span>
<span class="c1"># CHECKPOINT FILES</span>
<span class="c1">#------------------------</span>

<span class="n">amr</span><span class="o">.</span><span class="n">checkpoint_files_output</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">amr</span><span class="o">.</span><span class="n">check_file</span>              <span class="o">=</span> <span class="n">chk</span>    <span class="c1"># root name of checkpoint/restart file</span>
<span class="n">amr</span><span class="o">.</span><span class="n">check_int</span>               <span class="o">=</span> <span class="mi">500</span>    <span class="c1"># number of timesteps between checkpoints</span>

<span class="c1">#------------------------</span>
<span class="c1"># PLOTFILES</span>
<span class="c1">#------------------------</span>

<span class="n">amr</span><span class="o">.</span><span class="n">plot_files_output</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">amr</span><span class="o">.</span><span class="n">plot_file</span>         <span class="o">=</span> <span class="n">plt</span>     <span class="c1"># root name of plotfile</span>
<span class="n">amr</span><span class="o">.</span><span class="n">plot_int</span>          <span class="o">=</span> <span class="mi">100</span>     <span class="c1"># number of timesteps between plotfiles</span>

<span class="c1">#pick which all derived variables to plot</span>
<span class="n">amr</span><span class="o">.</span><span class="n">derive_plot_vars</span>  <span class="o">=</span> <span class="n">pressure</span> <span class="n">x_velocity</span> <span class="n">y_velocity</span>

<span class="c1"># probin filename that has tagging and other namelists</span>
<span class="n">amr</span><span class="o">.</span><span class="n">probin_file</span> <span class="o">=</span> <span class="n">probin</span>
<span class="c1"># ---------------------------------------------------------------</span>

<span class="c1"># ---------------------------------------------------------------</span>
<span class="n">Embedded</span> <span class="n">boundary</span> <span class="p">(</span><span class="n">EB</span><span class="p">)</span> <span class="n">inputs</span>
<span class="c1"># ---------------------------------------------------------------</span>

<span class="n">pelec</span><span class="o">.</span><span class="n">eb_isothermal</span> <span class="o">=</span> <span class="mi">1</span>     <span class="c1"># isothermal wall at EB</span>
<span class="n">pelec</span><span class="o">.</span><span class="n">eb_boundary_T</span> <span class="o">=</span> <span class="mf">300.</span>  <span class="c1"># EB wall temperature</span>
<span class="n">eb_verbosity</span> <span class="o">=</span> <span class="mi">1</span>            <span class="c1"># verbosity of EB data</span>


<span class="c1">#------------------------</span>
<span class="c1"># EB geometry</span>
<span class="c1">#------------------------</span>

<span class="n">eb2</span><span class="o">.</span><span class="n">geom_type</span> <span class="o">=</span> <span class="n">sphere</span>
<span class="n">eb2</span><span class="o">.</span><span class="n">sphere_radius</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">eb2</span><span class="o">.</span><span class="n">sphere_center</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="mf">0.15</span> <span class="mf">0.075</span>
<span class="n">eb2</span><span class="o">.</span><span class="n">sphere_has_fluid_inside</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># ---------------------------------------------------------------</span>
</pre></div>
</div>
</div>
<div class="section" id="tutorials">
<span id="id2"></span><h2>Tutorials<a class="headerlink" href="#tutorials" title="Permalink to this headline">¶</a></h2>
<p>The several cases in the <em>ExecCpp/Tutorials</em> directory are a good starting point for setting up a new PeleC case. In addition, there are several <a class="reference external" href="https://amrex-codes.github.io/amrex/docs_html/Basics.html#example-heatequation-ex1-c">tutorials from AMReX</a> that may be useful for general familiarity with how to build and run AMReX codes.</p>
<div class="section" id="eb-sphere">
<h3>EB_Sphere<a class="headerlink" href="#eb-sphere" title="Permalink to this headline">¶</a></h3>
<p>Reacting flow around a sphere</p>
</div>
<div class="section" id="eb-obliqshock">
<h3>EB_ObliqShock<a class="headerlink" href="#eb-obliqshock" title="Permalink to this headline">¶</a></h3>
<p>Supersonic flow over a wedge resulting in a steady attached oblique shock</p>
</div>
<div class="section" id="eb-bluffbody">
<h3>EB_BluffBody<a class="headerlink" href="#eb-bluffbody" title="Permalink to this headline">¶</a></h3>
<p>Non-reacting flow around a diamond-shaped body</p>
</div>
<div class="section" id="eb-channel">
<h3>EB_Channel<a class="headerlink" href="#eb-channel" title="Permalink to this headline">¶</a></h3>
<p>Laminar non-reacting flow in a pressure-driven channel (oriented at an angle with respect to the grid)</p>
</div>
<div class="section" id="eb-stube">
<h3>EB_stube<a class="headerlink" href="#eb-stube" title="Permalink to this headline">¶</a></h3>
<p>Shock tube problem in a rotating tube (using similar infrastructure as EB_Channel)</p>
</div>
</div>
<div class="section" id="testing-and-verification">
<span id="testing"></span><h2>Testing and Verification<a class="headerlink" href="#testing-and-verification" title="Permalink to this headline">¶</a></h2>
<p>Testing and verfication of PeleC can be performed using CTest, which is included in the CMake build system. If one builds PeleC with CMake, the testing suite, and the verification suite, can be enabled during the CMake configure step. A nightly test is reflected on the dashboard <a class="reference external" href="https://my.cdash.org/index.php?project=PeleC">here</a> .</p>
<p>An example <code class="docutils literal notranslate"><span class="pre">cmake</span></code> configure command performed in the <code class="docutils literal notranslate"><span class="pre">Build</span></code> directory in PeleC is shown below with options relevant to the testing suite:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cmake</span> <span class="o">-</span><span class="n">DCMAKE_INSTALL_PREFIX</span><span class="p">:</span><span class="n">PATH</span><span class="o">=./</span><span class="n">install</span> \
      <span class="o">-</span><span class="n">DCMAKE_BUILD_TYPE</span><span class="p">:</span><span class="n">STRING</span><span class="o">=</span><span class="n">Release</span> \
      <span class="o">-</span><span class="n">DPELEC_ENABLE_MPI</span><span class="p">:</span><span class="n">BOOL</span><span class="o">=</span><span class="n">ON</span> \
      <span class="o">-</span><span class="n">DCMAKE_CXX_COMPILER</span><span class="p">:</span><span class="n">STRING</span><span class="o">=</span><span class="n">mpicxx</span> \
      <span class="o">-</span><span class="n">DCMAKE_C_COMPILER</span><span class="p">:</span><span class="n">STRING</span><span class="o">=</span><span class="n">mpicc</span> \
      <span class="o">-</span><span class="n">DCMAKE_Fortran_COMPILER</span><span class="p">:</span><span class="n">STRING</span><span class="o">=</span><span class="n">mpifort</span> \
      <span class="o">-</span><span class="n">DENABLE_FCOMPARE</span><span class="p">:</span><span class="n">BOOL</span><span class="o">=</span><span class="n">ON</span> \
      <span class="o">-</span><span class="n">DENABLE_TESTS</span><span class="p">:</span><span class="n">BOOL</span><span class="o">=</span><span class="n">ON</span> \
      <span class="o">-</span><span class="n">DENABLE_FCOMPARE_FOR_TESTS</span><span class="p">:</span><span class="n">BOOL</span><span class="o">=</span><span class="n">OFF</span> \
      <span class="o">-</span><span class="n">DPELEC_ENABLE_MASA</span><span class="p">:</span><span class="n">BOOL</span><span class="o">=</span><span class="n">ON</span> \
      <span class="o">-</span><span class="n">DMASA_DIR</span><span class="p">:</span><span class="n">STRING</span><span class="o">=/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">masa</span><span class="o">/</span><span class="nb">dir</span> \
      <span class="o">-</span><span class="n">DPELEC_USE_CPP</span><span class="p">:</span><span class="n">BOOL</span><span class="o">=</span><span class="n">ON</span> \
      <span class="o">..</span>
</pre></div>
</div>
<p>While performing a <code class="docutils literal notranslate"><span class="pre">cmake</span> <span class="pre">-LAH</span> <span class="pre">..</span></code> command will give descriptions of every option for the CMake project. Descriptions of particular options regarding the testing suite are listed below:</p>
<p><strong>ENABLE_FCOMPARE</strong> – builds the <code class="docutils literal notranslate"><span class="pre">fcompare</span></code> utility from AMReX as well as the executable(s), to allow for testing differences between plot files</p>
<p><strong>ENABLE_TESTS</strong> – enables the base level regression test suite that will check whether each test will run its executable to completion successfully</p>
<p><strong>ENABLE_FCOMPARE_FOR_TESTS</strong> – enables an additional step in the regression tests where the <code class="docutils literal notranslate"><span class="pre">fcompare</span></code> program from AMReX will also test for differences in the plots generated from the tests against “gold” files which contain previously verified results to machine precision</p>
<p><strong>ENABLE_MASA</strong> – enables the verification suite which checks that PeleC is second order accurate using several additional tests, but note that the verification tests can take a significant amount of time to run and certain Python modules are expected to exist on the user’s system to generate PNG plot files</p>
<p><strong>PELEC_ENABLE_MASA</strong> and <strong>MASA_DIR</strong> – are required when the verification suite is enabled to perform the method of manufactured solutions</p>
<div class="section" id="building-the-tests">
<h3>Building the Tests<a class="headerlink" href="#building-the-tests" title="Permalink to this headline">¶</a></h3>
<p>Once the user has performed the CMake configure step, the <code class="docutils literal notranslate"><span class="pre">make</span></code> command will build every executable required for each test. In this step, it is highly beneficial for the user to use the <code class="docutils literal notranslate"><span class="pre">-j</span></code> option for <code class="docutils literal notranslate"><span class="pre">make</span></code> to build source files in parallel. It is also beneficial if the user has access to the Ninja build system with Fortran support which is described in the section on building PeleC.</p>
</div>
<div class="section" id="running-the-tests">
<h3>Running the Tests<a class="headerlink" href="#running-the-tests" title="Permalink to this headline">¶</a></h3>
<p>Once the test executables are built, CTest also creates working directories for each test within the <code class="docutils literal notranslate"><span class="pre">Build</span></code> directory where plot files will be output, etc. This directory is analogous to the source location of the tests in <code class="docutils literal notranslate"><span class="pre">Testing/test_files</span></code>.</p>
<p>To run the test suite, run <code class="docutils literal notranslate"><span class="pre">ctest</span></code> in the <code class="docutils literal notranslate"><span class="pre">Build</span></code> directory. CTest will run the tests and report their exit status. Useful options for CTest are <code class="docutils literal notranslate"><span class="pre">-VV</span></code> which runs in a verbose mode where the output of each test can be seen. <code class="docutils literal notranslate"><span class="pre">-R</span></code> where a regex string can be used to run specific sets of tests. <code class="docutils literal notranslate"><span class="pre">-j</span></code> where CTest will bin pack and run tests in parallel based on how many processes each test is specified to use and fit them into the amount of cores available on the machine. <code class="docutils literal notranslate"><span class="pre">-L</span></code> where the subset of tests containing a particular label will be run. Output for the last set of tests run is available in the <code class="docutils literal notranslate"><span class="pre">Build</span></code> directory in <code class="docutils literal notranslate"><span class="pre">Testing/Temporary/LastTest.log</span></code>.</p>
</div>
<div class="section" id="adding-tests">
<h3>Adding Tests<a class="headerlink" href="#adding-tests" title="Permalink to this headline">¶</a></h3>
<p>Developers are encouraged to add tests to PeleC and in this section we describe how the tests are organized in the CTest framework. The locations of the tests are in <code class="docutils literal notranslate"><span class="pre">PeleC/Tests</span></code>. To add a test, first create a test directory with a name in <code class="docutils literal notranslate"><span class="pre">PeleC/ExecCpp/&lt;test_exe&gt;/tests/&lt;test_name&gt;</span></code>. Place the input file for the test as <code class="docutils literal notranslate"><span class="pre">PeleC/Tests/&lt;test_exe&gt;/tests/&lt;test_name&gt;/&lt;test_name&gt;.i</span></code> along with any other files necessary for the test. Any file in the test directory will be copied during CMake configure to the test’s working directory. Next, edit the <code class="docutils literal notranslate"><span class="pre">PeleC/Tests/CMakeLists.txt</span></code> file, add the test to the list. Note there are different categories of tests and if your test falls outside of these categories, a new function to add the test will need to be created. After these steps, your test will be automatically added to the test suite database when doing the CMake configure with the testing suite enabled.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="BoundaryConditions.html" class="btn btn-neutral float-right" title="Boundary Conditions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Algorithms.html" class="btn btn-neutral float-left" title="Numerical Treatment and Algorithms" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright AMReX Copyright (c) 2017, The Regents of the University of California, through Lawrence Berkeley National Laboratory and the Alliance for Sustainable Energy, LLC., through National Renewable Energy Laboratory (subject to receipt of any required approvals from the U.S. Dept. of Energy).  All rights reserved.

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>